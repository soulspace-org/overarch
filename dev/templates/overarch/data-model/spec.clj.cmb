;;;
;;; Element Spec 
;;;
(ns overarch.domain
  (:require [clojure.spec.alpha :as s]
            [expound.alpha :as expound]))
<%
;; Template functions
(def type-preds {"collection" "coll"})
(defn type-pred
  [field]
  (str (get type-preds (:type field) (:type field)) "?"))
 %>

;; Spec for keys
<%(doseq [field (m/all-fields e)]%>
; <%= (:desc field) %>
(s/def :overarch/<%=(:name field)%> <%=(type-pred field)%>)
<%)%>

;; Spec for model elements
<%(doseq [element (filterv (and (fn [el] (= :class (:el el)))
                                 (fn [el] (true? (:abstract el))))
                           e)]%>
; <%= (first (str/split-lines (:desc element))) %>
(s/def :overarch/<%=(:name element)%>
  (s/keys :req-un []
          :opt-un []))
<%)%>
